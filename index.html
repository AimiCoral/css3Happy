<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
	<title>妈咪生日快乐</title>
	<link rel="stylesheet" href="fonts/iconfont.css">
	<link rel="stylesheet" href="css/swiper.min.css">
	<link rel="stylesheet" href="css/animate.min.css">
	<link rel="stylesheet" href="css/style.css">
	<style>
		html, body {
	      position: relative;
	      height: 100%;
	    }
	    body {
	      background: #eee;
	      font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
	      font-size: 14px;
	      color:#000;
	      margin: 0;
	      padding: 0;
	    }
	</style>
</head>
<body>
	<div class="swiper-box">
		<div class="swiper-container">
		    <div class="swiper-wrapper">
		      	<div class="swiper-slide slide1">
		      		<img class="Nightext2 Nightext ani" swiper-animate-effect="fadeInLeft" swiper-animate-duration="0.3s" swiper-animate-delay="0.5s" src="images/night2.png" alt="">
		      		<img class="Nightext3 Nightext ani" swiper-animate-effect="fadeInUp" swiper-animate-duration="0.3s" swiper-animate-delay="0.8s" src="images/night3.png" alt="">
		      	</div>
		      	<div class="swiper-slide ">
		      		<div class="slide2">
		      			<img class=" winter winter1 ani" src="images/winter1.png" swiper-animate-effect="fadeInDown" swiper-animate-duration="0.3s" swiper-animate-delay="0.1s" alt="">
		      			<img class="winter winter2 ani" src="images/winter2.png" swiper-animate-effect="fadeInDown" swiper-animate-duration="0.3s" swiper-animate-delay="0.4s" alt="">
		      			<img class="winter winter3 ani" src="images/winter3.png" swiper-animate-effect="fadeInDown" swiper-animate-duration="0.3s" swiper-animate-delay="0.7s" alt="">
			      		<img class="backg" src="images/timg22.png" alt="">
		      		</div>
		      	</div>
		        <div class="swiper-slide doorSlide">
			      	<div class="RoomBox">
			      		<img class="GiftBox ani" src="images/giftbox.png" swiper-animate-effect="bounceInDown" swiper-animate-duration="5s" swiper-animate-delay="0.1s" alt="">
						<div class="Blessings">
							<div class="happy animated slideInLeft"></div>
						</div>

					</div>
		        </div>
		        <div class="swiper-slide pinkBack">
		        	<div class="redenvel_title  ani" swiper-animate-effect="flipInX" swiper-animate-duration="0.5s">
		        		<img src="images/szf2.png" alt="">
		        	</div>
		        	<div class="Luckynum">共收到 0 个福包</div>
		        	<div class="Luckylook animated pulse"></div>
		      	 	<div class="redenvel_main"></div>
					<div class="diyPrompt">
						<div class="prompt_main">
							<div class="prompt_main_title">消息提示</div>
							<div class="close">×</div>
							<div class="prompt_main_cont">生日快乐，身体健康。永远18岁</div>
							<div class="rightFont"></div>
							<div class="goAgainbtn">再来一次</div>
						</div>
					</div>
					<div class="LuckyPrompt">
						<div class="LuckylistBox">
							<div class="Lucky_title">福气多多 <div class="close">×</div></div>
							<ul class="Luckylist">
								<!-- <li class="Lucky_title">福气多多<div class="close">×</div></li> -->
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>
								<li>
									<div class="LuckyImg"><img src="images/dd.jpg" alt=""></div>
									<div class="Luckytext">生日快乐，身体健康。永远18岁</div>
								</li>

							</ul>
						</div>
						
					</div>
		      	</div>
		    </div>
		    <div class="musicBox">
		    	<span class="iconfont icon-yinle"></span>
		    </div>
		    <!-- <div class="nextPage animated bounce">︾</div> -->
		</div>
	</div>
	
	<script src="js/jquery-3.3.1.min.js"></script>
	<script src="js/swiper.min.js"></script>
	<script src="js/swiper.animate1.0.3.min.js"></script>
	<script src="js/jquery.nicescroll.min.js"></script>
	<script src="js/index.js"></script>
	<script>
		var rW = $(".redenvel_main").width(),
    	rH = $(".redenvel_main").height();
	    //飘落物体的可能性
	    var fd1 = '<img class="fdImg" src="images/fd1.png" alt="">';
	    // var fd2 = '<img class="fdImg" src="images/fd2.png" alt="">';
	    var dg1 = '<img src="images/dg1.png" alt="">';
	    // var dg2 = '<img src="images/dg2.png" alt="">';
	    var dg3 = '<img src="images/dg3.png" alt="">';
	    var dg4 = '<img src="images/dg4.png" alt="">';
	    var dg5 = '<img src="images/dg5.png" alt="">';
	    // var dg6 = '<img src="images/dg6.png" alt="">';
	    var arr=[dg1,dg3,fd1,dg5,dg1];
	   	var basePadding = 15;
	   	var num =0;
	   	var count=3;
	   	var fourSetInter;
	   	var countSetInter;
	   	var Luckynum;
	   	var zoomsetTime,
	   		foursetTime;
	   	var openGiftsetTime;
	   	function LuckyInit(){
	   		Luckynum=0;
      		count = 3;
      		$(".redenvel_count").text(count);
      		$(".Luckynum").text("共收到 "+Luckynum+" 个福包");
      		$(".diyPrompt").css("display",'none');
      		$(".Luckynum").css("display","none");
      		$(".Luckylook").css("display","none");
      		var countHtml ='<div class="redenvel_count animated pulse">'+count+'</div>';
      		$(".pinkBack").append(countHtml);
      		$(".swiper-wrapper .swiper-slide").eq(3).find(".redenvel_main").empty();
      		countSetInter = setInterval(function(){
      			count--;
      			$(".redenvel_count").text(count);
      			if(count<0){
      				clearInterval(countSetInter);
      				$(".redenvel_count").remove();
      				$(".Luckynum").css("display","block");
      			}
      		},1000)
      		num=0;
      		foursetTime = setTimeout(function(){
      			fourSetInter = setInterval(function(){
			    	addObj();
			    },700)
      		},3000)
		    zoomsetTime = setTimeout(function(){
		    	clearInterval(fourSetInter);
		    	$(".redenvel_main").empty();
		    	$(".diyPrompt").css("display",'block').find(".prompt_main_cont").text("这一波祝福结束，快来看看都收到了什么祝福吧");
		    	$(".diyPrompt .goAgainbtn").css("display",'none');
		    	setTimeout(function(){
    				$(".diyPrompt").css("display",'none');
    				$(".Luckylook").css("display",'block');
    			},1000)
      		},30000)
	   	}
		var swiper = new Swiper('.swiper-container', {
	        direction: 'vertical',
	        slidesPerView: 1,
	        spaceBetween:30,
	        mousewheel: true,
	        on: {//注册事件
			    slideChange: function () {
			      	console.log(this.activeIndex);
			      	if(this.activeIndex=="3"){
			      		LuckyInit();
			      		clearTimeout(openGiftsetTime);
			      	}else{
			      		//点福包
			      		clearInterval(fourSetInter);
			      		clearInterval(countSetInter);
			      		clearTimeout(foursetTime);
			      		clearTimeout(zoomsetTime);
			      		clearTimeout(openGiftsetTime);
			      		$(".LuckyPrompt").css({"display":"none"});
			      		$(".diyPrompt").css({"display":"none"});
			      		if(this.activeIndex=="2"){
			      			//礼包
			      			$(".RoomBox").find(".openGift").remove();
			      			$(".Blessings").css("display","none");
			      			$(".RoomBox").find(".careBox").remove();
			      			openGiftsetTime = setTimeout(function(){
			      				var openGift = '<div class="openGift animated pulse">点击打开礼盒</div>'
								$(".RoomBox").append(openGift);
			      			},5000)
				      	}
			      	}//else 不等于最后slide
			    },
			    init: function(){
			        swiperAnimateCache(this); //隐藏动画元素 
			        swiperAnimate(this); //初始化完成开始动画
			    }, 
			    slideChangeTransitionEnd: function(){ 
			        swiperAnimate(this); //每个slide切换结束时也运行当前slide动画
			        //this.slides.eq(this.activeIndex).find('.ani').removeClass('ani'); 动画只展现一次，去除ani类名
			    } 
			},
	    });
	    $(".nextPage").click(function(){
	    	swiper.slideNext();
	    })
	    
	     //1.获取容器的宽高
   
    //生成mix-max的随机数
	function getRandom(min, max) {
	  return Math.round(Math.random() * (max - min) + min);
	}

	//红包的移动
	function redPackageBoxSpeed($el, time) {
	  $el.animate(
	    {
	      top: '110%',
	    },
	    time * 1000,
	    function() {
	      $el.remove();
	    }
	  );
	};

    function addObj(){
    	num++;
    	var itemW = parseInt(Math.random() * 6 + 45);
    	var maxLeftPx = rW - itemW - basePadding * 2;
    	// var itemLeft = parseInt(Math.random() * (win - 0) + 0);
    	var rot = (parseInt(Math.random() * (45 - (-45)) - 45)) + "deg";
    	var time = parseInt(Math.random() * 3 + 9);
    	var Item ='<div class="redenvel_item item'+num+'">'+arr[Math.floor(Math.random() * arr.length)]+'</div>';
    	$(".redenvel_main").append(Item);
    	$('.item'+num+' .iconfont').css({
    		"fontSize":itemW+ 'px'
    	})
    	// console.log(getRandom(basePadding, maxLeftPx))
    	$('.item'+num+'').css({
    		"left":getRandom(basePadding, maxLeftPx) + 'px',
    		"width":itemW,
    		"transform": "rotate(" + rot + ")",
			"-webkit-transform": "rotate(" + rot + ")",
			"-ms-transform": "rotate(" + rot + ")", /* Internet Explorer */
			"-moz-transform": "rotate(" + rot + ")", /* Firefox */
			"-webkit-transform": "rotate(" + rot + ")",/* Safari 和 Chrome */
			"-o-transform": "rotate(" + rot + ")" /* Opera */
    	})
    	redPackageBoxSpeed($('.item'+num+''),time)

    }

    $(".redenvel_main").on("click",".redenvel_item",function(e){
    	e.preventDefault(); 
    	console.log($(this).find(".fdImg"))
    	if($(this).find(".fdImg").length>0){
    		if($(this).find(".fdImg").attr("data-active")){
    			return;
    		}else{
    			$(this).find(".fdImg").attr("data-active",true);
    			Luckynum++;
    		}
    	}else{
    		return;
    	}
    	$(".Luckynum").text("共收到 "+Luckynum+" 个福包")
    })
    var luckyArr=[
    	{"name":"bb","des":"老婆生日快乐"},
    	{"name":"dd","des":"老妈,你又长大一岁，终于成年了，哈哈。"},
    	{"name":"jj","des":"妈妈，你每天都要笑哦"},
    	{"name":"dd","des":"天天天真快乐；年年年轻漂亮"},
    	{"name":"bb","des":"老婆今天你做主,为你奋斗一辈子！我洗衣我擦地，让俺干啥都愿意！"},
    	{"name":"dd","des":""},
    	{"name":"jj","des":""},

    	{"name":"bb","des":"因为有你，我的世界才美丽，祝老婆大人生日快乐！"},

    	{"name":"bb","des":"爱你无需深情的言语，只要我们一直手牵手走下去就足矣"},

    	{"name":"bb","des":"一路走来，蒙你辛劳操持、相濡以沫、让我有这温馨的家，老婆你辛苦了"},

    	{"name":"bb","des":"祝老婆生日快乐,爱你!"},

    	{"name":"bb","des":"愿所有的快乐所有的幸福所有的温馨所有的好运围绕在你身边。生日快乐！"},
    ];
    $(".Luckylook").click(function(e){
    	e.stopPropagation();
    	if(Luckynum==0){
    		$(".diyPrompt").css("display",'block').find(".prompt_main_cont").text("怎么没有福包呢，你没有去点福包吧。");
    		$(".diyPrompt .goAgainbtn").css("display",'block');
    	}else{
    		$(".Luckylist").empty();
    		var c=[];
    		var m;
    		// if(Luckynum>6){
    		// 	Luckynum=6;
    		// }
    		for(var i=0;i<Luckynum;i++){
    			m=Math.floor(Math.random() * luckyArr.length);
    			if(c.indexOf(m)==-1){
    				m=Math.floor(Math.random() * luckyArr.length);
    				if(c.indexOf(m)==-1){
    					m=Math.floor(Math.random() * luckyArr.length);
    				}else{
    					c.push(m)
    				}
    			}else{
    				c.push(m)
    			}
				var html =  '<li>'+
								'<div class="LuckyImg"><img src="images/'+luckyArr[m].name+'.jpg" alt=""></div>'+
								'<div class="Luckytext">'+luckyArr[m].des+'</div>'+
							'</li>'
				$(".Luckylist").append(html)
    		}
    		$(".LuckyPrompt").css({"display":"block"});
		   	var lH=$(".LuckylistBox").height();
		   	$(".LuckylistBox").css({"margin-top":-(lH/2)});
    	}
    })
    $(".diyPrompt .close").click(function(){
    	$(".diyPrompt").css("display",'none');
    })
    $(".LuckyPrompt .close").click(function(){
    	$(".LuckyPrompt").css("display",'none');
    })
    $(".goAgainbtn").click(function(){
    	LuckyInit();
    })
    $(".musicBox").click(function(){
    	if($(this).find(".iconfont").hasClass("icon-yinle")){
    		$(this).find(".iconfont").removeClass("icon-yinle").addClass("icon-yinletingzhi24px");
    		$(this).css({"animation-play-state":"paused","-webkit-animation-play-state":"paused"});
    	}else{
    		$(this).find(".iconfont").addClass("icon-yinle").removeClass("icon-yinletingzhi24px");
    		$(this).css({"animation-play-state":"running","-webkit-animation-play-state":"running"});
    	}
    })
    $('.LuckylistBox').niceScroll({
	    cursorcolor: "#E8E8E8",//#CC0071 光标颜色
	    cursoropacitymax: 1, //改变不透明度非常光标处于活动状态（scrollabar“可见”状态），范围从1到0
	    touchbehavior: false, //使光标拖动滚动像在台式电脑触摸设备
	    cursorwidth: "5px", //像素光标的宽度
	    cursorborder: "0", // 游标边框css定义
	    cursorborderradius: "5px",//以像素为光标边界半径
	    autohidemode: false //是否隐藏滚动条
	});
	</script>
</body>
</html>